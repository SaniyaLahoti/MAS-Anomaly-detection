INFO:     Started server process [14415]
INFO:     Waiting for application startup.
WARNING:absl:Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
WARNING:absl:Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
üöÄ Starting Multi-Agent Anomaly Detection API...
üöÄ Initializing Multi-Agent System...
================================================================================
INTERPRETER AGENT - INITIALIZING ENSEMBLE SYSTEM
================================================================================

ü§ñ AGENT 1: XGBoost + SHAP
--------------------------------------------------------------------------------
================================================================================
SHAP EXPLAINABILITY SYSTEM - LOADING MODELS
================================================================================
‚úÖ Stage 1 model loaded (4-class classification)
‚úÖ Stage 2 model loaded (DDoS vs DoS binary)
‚úÖ Scalers and encoders loaded
‚úÖ Feature names loaded: 23 features

üìä Classes:
  Stage 1: ['Benign', 'DOS', 'Reconnaissance', 'Theft']
  Stage 2: ['DDoS', 'DoS']

================================================================================
CREATING SHAP EXPLAINERS
================================================================================

üîß Creating Stage 1 SHAP explainer...
‚ö†Ô∏è  Using alternative explainer method for Stage 1: could not convert string to float: '[2.5E-1,2.5E-1...

üîß Creating Stage 2 SHAP explainer...
‚ö†Ô∏è  Using alternative explainer method for Stage 2: could not convert string to float: '[5E-1]'...
‚úÖ XGBoost Agent ready

ü§ñ AGENT 2: LSTM + SHAP
--------------------------------------------------------------------------------
================================================================================
LSTM SHAP EXPLAINABILITY SYSTEM - LOADING MODELS
================================================================================
‚úÖ Stage 1 LSTM model loaded
‚úÖ Stage 2 LSTM model loaded
‚úÖ Scalers and encoders loaded
‚úÖ Feature names loaded: 23 features

üìä Classes:
  Stage 1: ['Benign', 'DOS', 'Reconnaissance', 'Theft']
  Stage 2: ['DDoS', 'DoS']

================================================================================
CREATING LSTM SHAP DEEP EXPLAINERS
================================================================================

üîß Creating Stage 1 GradientExplainer...
‚úÖ Stage 1 GradientExplainer ready

üîß Creating Stage 2 GradientExplainer...
‚úÖ Stage 2 GradientExplainer ready
‚úÖ LSTM Agent ready

================================================================================
‚úÖ ENSEMBLE SYSTEM INITIALIZED
================================================================================
‚úÖ Multi-Agent System ready!
INFO:     127.0.0.1:54715 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:54718 - "GET / HTTP/1.1" 200 OK

================================================================================
ENSEMBLE PREDICTION & INTERPRETATION
================================================================================

ü§ñ Agent 1 (XGBoost) analyzing...
   XGBoost: Theft (99.8%)

ü§ñ Agent 2 (LSTM) analyzing...
üîç Computing Stage 1 SHAP values...
   LSTM: Theft (100.0%)

üîÆ ENSEMBLE VOTING:
--------------------------------------------------------------------------------
‚úÖ FULL AGREEMENT: Theft
   Combined Confidence: 99.9%
INFO:     127.0.0.1:54720 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:57585 - "GET / HTTP/1.1" 200 OK

================================================================================
ENSEMBLE PREDICTION & INTERPRETATION
================================================================================

ü§ñ Agent 1 (XGBoost) analyzing...
   XGBoost: DoS (50.8%)

ü§ñ Agent 2 (LSTM) analyzing...
üîç Computing Stage 1 SHAP values...
üîç Computing Stage 2 SHAP values...
   LSTM: DoS (52.5%)

üîÆ ENSEMBLE VOTING:
--------------------------------------------------------------------------------
‚úÖ FULL AGREEMENT: DoS
   Combined Confidence: 51.7%
INFO:     127.0.0.1:57600 - "POST /predict HTTP/1.1" 200 OK
